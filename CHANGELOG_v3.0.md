# 智能地址填充助手 v3.0 - 更新说明

## 🎉 重大更新

v3.0版本是一次全面重构，专注于**100%真实地址生成**和**智能表单填充**。

---

## ✨ 主要更新

### 1. 纯API模式 - 真实地址生成

**删除了离线模式，专注于真实数据**
- ✅ 使用 OpenStreetMap API 获取真实存在的地址
- ✅ 使用 RandomUser.me API 获取真实姓名和Email
- ✅ 所有地址都可以在地图上验证
- ✅ 100%符合各国地址格式规范

**为什么删除离线模式？**
- 真实地址对于实际使用场景更有价值
- 简化代码架构，提升维护性
- 专注于解决实际问题而非提供演示数据

### 2. 支持20个国家 🌍

从原来的8个国家扩展到20个：

| 地区 | 国家 |
|------|------|
| 亚洲 | 🇨🇳 中国、🇯🇵 日本、🇰🇷 韩国、🇮🇳 印度、🇸🇬 新加坡、🇹🇭 泰国 |
| 欧洲 | 🇬🇧 英国、🇩🇪 德国、🇫🇷 法国、🇮🇹 意大利、🇪🇸 西班牙、🇳🇱 荷兰、🇸🇪 瑞典、🇨🇭 瑞士、🇷🇺 俄罗斯 |
| 美洲 | 🇺🇸 美国、🇨🇦 加拿大、🇧🇷 巴西、🇲🇽 墨西哥 |
| 大洋洲 | 🇦🇺 澳大利亚 |

每个国家包含4-6个主要城市的地址数据。

### 3. 增强的字段识别 🎯

**全新的智能识别系统**
- ✅ **优先级匹配**：按字段重要性排序（Email > 姓名 > 电话 > 地址）
- ✅ **排除规则**：避免误识别（Email不会填入地址字段）
- ✅ **分离姓名**：自动识别firstName/lastName分开字段
- ✅ **Email专用识别**：高优先级防止混淆
- ✅ **多语言支持**：支持中英法德西等语言字段名

**支持的字段类型：**
```
✓ firstName / lastName / fullName (姓名分离)
✓ email (独立识别，不会误填)
✓ phone (电话号码)
✓ countryCode (国家代码/区号)
✓ postal / zipCode (邮编)
✓ state / province (省/州)
✓ city (城市)
✓ address / address1 (详细地址)
✓ address2 (地址第2行)
✓ country (国家)
```

### 4. 下拉框智能填充 📋

**新增下拉选择框支持**
- ✅ **国家下拉框**：支持国家代码(CN)和国家名称(China)匹配
- ✅ **国家代码下拉框**：支持+86、86、+86 China等多种格式
- ✅ **省/州下拉框**：智能匹配省份名称
- ✅ **通用下拉框**：支持精确和模糊匹配

**示例场景：**
```html
<!-- 这些下拉框都能自动填充 -->
<select name="country">
  <option value="CN">China</option>
  <option value="US">United States</option>
</select>

<select name="phone-code">
  <option value="+86">+86 (China)</option>
  <option value="+1">+1 (USA)</option>
</select>
```

### 5. 完整的电话号码信息 📞

**多格式电话号码**
- `phone`: 本地格式 (例如：13812345678)
- `phoneWithCountryCode`: 带国家代码 (例如：+86 13812345678)
- `countryCode`: +86格式
- `callingCode`: 86格式（纯数字）

**智能填充策略：**
- 输入框：填充带国家代码的完整号码
- 下拉框：填充纯数字区号
- 自动识别phone-code、country-code等字段

### 6. 真实Email地址 📧

**从API获取真实Email**
- 来自RandomUser.me API的真实格式Email
- 格式示例：`john.smith@example.com`
- 高优先级字段识别，避免误填到其他字段

### 7. Label智能识别 🏷️

**增强的字段识别能力**
- 读取HTML的`<label>`标签文本
- 支持`label[for="input-id"]`关联
- 支持父级label元素
- 支持兄弟label元素
- 综合分析name、id、class、placeholder、aria-label等属性

---

## 🔧 技术改进

### 代码架构优化

**删除的文件：**
- `addressGenerator.js` (离线生成器，已移除)

**更新的文件：**
- `apiAddressGenerator.js` - 扩展到20国，优化数据结构
- `content.js` - 完全重写，500+行智能填充逻辑
- `popup.js` - 简化代码，移除离线模式
- `popup.html` - 新增Email字段，20国选项
- `popup.css` - 精简样式

### 性能优化

- **优先级排序**：先处理重要字段，减少重复填充
- **智能跳过**：已填充同类型字段自动跳过
- **事件优化**：触发多种事件确保兼容各框架

### 兼容性提升

**支持的前端框架：**
- ✅ 原生HTML表单
- ✅ React / Next.js
- ✅ Vue / Nuxt
- ✅ Angular
- ✅ jQuery

**事件触发：**
```javascript
input, change, blur, keyup, keydown
InputEvent (React等现代框架)
```

---

## 📊 对比表格

| 特性 | v2.0 | v3.0 |
|------|------|------|
| 地址真实性 | 双模式（离线/在线） | 纯API，100%真实 |
| 支持国家 | 8个 | 20个 |
| 姓名处理 | 仅fullName | firstName + lastName + fullName |
| Email字段 | ❌ | ✅ 独立识别 |
| 电话格式 | 单一格式 | 4种格式 |
| 下拉框填充 | 基础支持 | 智能多格式匹配 |
| 字段优先级 | 无 | 有(200-50) |
| Label识别 | 基础 | 多层级智能识别 |
| 排除规则 | 无 | 防止误填充 |

---

## 🚀 使用方法

### 基本使用

1. 选择国家（20个国家可选）
2. 点击"生成随机地址"
3. 等待2-5秒获取真实地址
4. 点击"填充到当前页面"

### 高级功能

**保存历史记录：**
- 生成地址后点击"保存到历史"
- 最多保存20条记录
- 可随时重新使用历史地址

**复制地址：**
- 点击"复制地址"获取完整信息
- 包含姓名（分离格式）、Email、电话、地址等

---

## ⚠️ 已知限制

1. **API速率限制**
   - OpenStreetMap: 1次/秒
   - 已实现自动延迟控制

2. **网络依赖**
   - 需要稳定的网络连接
   - API失败时会显示错误提示

3. **地址详细度**
   - 部分城市可能需要多次重试才能获取详细地址
   - 已实现最多5次自动重试

---

## 🐛 问题修复

### v3.0修复的问题

✅ **姓名不分离** → 现在支持firstName/lastName独立字段
✅ **Email被误填地址** → 高优先级独立识别
✅ **电话号码无国家代码** → 4种格式支持
✅ **下拉框无法填充** → 智能多格式匹配
✅ **国家/省份下拉框识别失败** → 专用填充逻辑

---

## 📝 升级指南

### 从v2.0升级

1. **删除旧版扩展**
2. **重新加载新版本**
3. **测试基本功能**

**注意事项：**
- 历史记录会保留
- 离线模式不再可用
- 所有地址都是真实API生成

---

## 🔮 未来计划

- [ ] 添加更多国家（目标：50+）
- [ ] 支持公司地址vs个人地址
- [ ] 自定义字段映射
- [ ] 批量生成地址
- [ ] 导出/导入历史记录
- [ ] 浏览器同步

---

## 📄 许可证

本项目仅供学习和测试使用。

## 🙏 致谢

- OpenStreetMap API - 真实地址数据
- RandomUser.me API - 真实用户信息
- 所有贡献者和用户的反馈

---

**版本：** v3.0
**发布日期：** 2024-11-06
**开发者：** Claude + 用户协作
